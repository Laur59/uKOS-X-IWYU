> [!WARNING]
>
> Version 0.0.0 to 1.x.x    Reserved for EFr & LVa & ARo
>

# uKOS-X Pack v. 1.x.x

(c) 2025-20xx, Edo. Franzi, 2025-01-01

The first step (compulsary) to do before using uKOS-X is to define the environment variable
giving the root path where uKOS-X is located (typically git clone destination):

```bash
PATH_UKOS_X_PACKAGE=Absolute_path_of_git_cloned_directory
export PATH_UKOS_X_PACKAGE
```

## Prerequisites

The installation of **ÂµKOS-X** requires a set of development tools and supporting packages. Before proceeding, ensure that the following components are available on your system. You may use **any package manager you prefer** (e.g., MacPorts, Homebrew, etc.). If no specific version is mentioned for a package, you should install the latest version available. In this documentation, **MacPorts** was used for macOS and **APT** for Ubuntu as examples, but the choice is entirely up to you.

automake
libtool
autoconf
pkgconfig
coreutils
md5sha1sum
ghostscript
texinfo
ctags
wget
hidapi
python3.13
ninja
meson
bison
pandoc
gmake
zlib
yq

## Custom toolchain already in place

In this case, is is sufficient to initialise the paths where the toolchains are located

```bash
PATH_TOOLS_ROOT=Your_Root_Path_To_The_Tools
PATH_TOOLS_UNIX=${PATH_TOOLS_ROOT}/local/bin

PATH_GCC_ARM=Your_Path_To_The_gcc_arm
PATH_GCC_RVXX=Your_Path_To_The_gcc_riscv
PATH_LLVM_ARM=Your_Path_To_The_llvm_arm
PATH_LLVM_RVXX=Your_Path_To_The_llvm_riscv

PATH=${PATH}:${PATH_TOOLS_UNIX}

export PATH_TOOLS_ROOT
export PATH_TOOLS_UNIX
export PATH_GCC_ARM
export PATH_GCC_RVXX
export PATH_LLVM_ARM
export PATH_LLVM_RVXX
```

## Installation for macOS & Ubuntu

For building the uKOS-X package it is necessary to configure and to install some tools (e.g compilers, python modules, etc). The step-by-step tool installation is presented in the documents **INSTALLATION_OSX.md** (for macOS machines) and **INSTALLATION_Ubuntu.md** (for Linux machines). A quick installation is presented in the documents **INSTALLATION_Quick.md**  (only for Arm cores).

For setting-up the package environment it is necessary to set a couple of PATHs:

```bash
# The root path where the tools are located, e.g.
PATH_TOOLS_ROOT=/opt/uKOS
```

## Building the package

Once the installation is terminated, we can build all the targets and start to work with the OS.

### Building TinyUSB

```bash
cd ${PATH_UKOS_X_PACKAGE}/Third_Parties/TinyUSB
./build.sh
```

### Building MicroPython

```bash
cd ${PATH_UKOS_X_PACKAGE}/Third_Parties/MicroPython
./build.sh
```

### Building FatFs

```bash
cd ${PATH_UKOS_X_PACKAGE}/Third_Parties/FatFs
./build.sh
```

### Building TFLite-micro

```bash
cd ${PATH_UKOS_X_PACKAGE}/Third_Parties/Tflite-micro

# Create a python environment

python3.13 -m venv Tflite-env
source Tflite-env/bin/activate
pip install numpy tensorflow pillow ai-edge-litert

./build.sh
```

### Building Doxygen-awesome

```bash
cd ${PATH_UKOS_X_PACKAGE}/Third_Parties/Doxygen-awesome
./build.sh
```

### Building IntelRDFPMath

```bash
cd ${PATH_UKOS_X_PACKAGE}/Third_Parties/IntelRDFPMath
./build.sh
```

### Building the on-line package documentation

```bash
cd ${PATH_UKOS_X_PACKAGE}/Documentation/Doxygen
./build.sh
```

At the end of the documentation construction, a **html** folder should be visible. Just open the file **index.html** with a browser and navigate in the documentation.

### Building all the targets of the package

```bash
cd ${PATH_UKOS_X_PACKAGE}/Ports/Targets
./build.sh
```

In the folder Targets you can read the document **README.md** for more information.

### Possible operations with one target

For building one specific target we simply need to enter in the **System** folder of the target and play with **make**. For example, if we need to **build** and **burn** the **FLASH** of the target **Nucleo_H743**.

```bash
cd ${PATH_UKOS_X_PACKAGE}/Ports/Nucleo_H743/Variant_Test/System
make -j
make burn

# The make can be followed by parameters that can be combined:
# e.g.
# make -j CANARY=0            Suppress detection if a buffer overflow in stack
# make -j USER_MODE=0         Compile the system without the privileged/user separation
# make -j NOLISTING=1         Do not generate the .dis & .lst.
# make -j NOCLEAN=1           Keep the object files
# make -j VERBOSE=1           Display the compiler command line
# make -j TARGET=name         Name is the final result name (e.g. name.elf, name.s3, etc)
# make burn                   Program the flash of the target cpu
```

### Preparing the first target (e.g. Nucleo_H743)

```bash
cd ${PATH_UKOS_X_PACKAGE}/Ports/Nucleo_H743/Variant_Test/System
make -j USER_MODE=1

make burn
```

#### Working with the target

1. Connect a serial terminal (e.g. CoolTerm) set with the baudrate **460800-b/s**

2. Push reset. On the terminal the OS prompt should appear
